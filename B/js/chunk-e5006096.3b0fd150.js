(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e5006096"],{"0076":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[1==e.editAllGameType?a("h3",[a("Icon",{attrs:{type:"md-add-circle",size:"24"}}),e._v("新增主游戏")],1):2==e.editAllGameType?a("h3",[a("Icon",{attrs:{type:"md-paper",size:"24"}}),e._v("编辑主游戏")],1):e._e(),a("Form",{ref:"formData",attrs:{model:e.formData,rules:e.ruleValidate,"label-width":130}},[a("div",{staticClass:"formBox"},[a("FormItem",{staticClass:"nameBox",attrs:{label:"游戏名称",prop:"name"}},[a("Input",{attrs:{clearable:""},on:{"on-blur":e.checkName,"on-clear":function(t){return e.clearGameNameStatus()}},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}}),a("span",{class:{err1:"ok"!=e.checkNameStatus}},[e._v(e._s(e.checkNameStatus))])],1),1==e.type_category?a("FormItem",{attrs:{label:"游戏状态",prop:"state"}},[a("Select",{model:{value:e.formData.state,callback:function(t){e.$set(e.formData,"state",t)},expression:"formData.state"}},[a("Option",{attrs:{value:"1"}},[e._v("正常")]),a("Option",{attrs:{value:"2"}},[e._v("下架")]),a("Option",{attrs:{value:"3"}},[e._v("删除")])],1)],1):e._e(),a("FormItem",{attrs:{label:"是否原创",prop:"original"}},[a("Select",{model:{value:e.formData.original,callback:function(t){e.$set(e.formData,"original",t)},expression:"formData.original"}},[a("Option",{attrs:{value:"1"}},[e._v("是")]),a("Option",{attrs:{value:"2"}},[e._v("否")])],1)],1)],1),a("FormItem",{attrs:{label:"游戏类型",prop:"type"}},[a("RadioGroup",{model:{value:e.formData.type,callback:function(t){e.$set(e.formData,"type",t)},expression:"formData.type"}},e._l(e.configData.game_type,(function(t,n){return a("Radio",{key:n,attrs:{label:n}},[e._v(e._s(t))])})),1)],1),a("FormItem",{attrs:{label:"游戏模式",prop:"game_methon"}},[a("RadioGroup",{model:{value:e.formData.game_methon,callback:function(t){e.$set(e.formData,"game_methon",t)},expression:"formData.game_methon"}},e._l(e.configData.game_methon,(function(t,n){return a("Radio",{key:n,attrs:{label:n}},[e._v(e._s(t))])})),1)],1),a("FormItem",{staticClass:"smallest",attrs:{label:"推荐设置",prop:"recom"}},[a("Select",{model:{value:e.formData.recom,callback:function(t){e.$set(e.formData,"recom",t)},expression:"formData.recom"}},e._l(e.configData.game_recom,(function(t,n){return a("Option",{key:n,attrs:{value:n}},[e._v(e._s(t))])})),1)],1),a("FormItem",{attrs:{label:"标签关联",prop:"tags"}},[e.isLoaded?a("TagsAdd",{ref:"tagsAddSwitch1",attrs:{tagsAddConfig:e.tagsAddConfig1}}):e._e()],1),a("FormItem",{attrs:{label:"关联游戏",prop:"tags"}},[e.isLoaded?a("TagsAdd",{ref:"tagsAddSwitch2",attrs:{tagsAddConfig:e.tagsAddConfig2}}):e._e()],1),a("FormItem",{attrs:{label:"是否更改更新时间",prop:"check_updateTime"}},[a("RadioGroup",{model:{value:e.formData.check_updateTime,callback:function(t){e.$set(e.formData,"check_updateTime",t)},expression:"formData.check_updateTime"}},[a("Radio",{attrs:{label:"1"}},[e._v("是")]),a("Radio",{attrs:{label:"0"}},[e._v("否")])],1)],1),a("FormItem",{attrs:{label:"展示下载聚合页",prop:"show_down"}},[a("RadioGroup",{model:{value:e.formData.show_down,callback:function(t){e.$set(e.formData,"show_down",t)},expression:"formData.show_down"}},[a("Radio",{attrs:{label:"1"}},[e._v("是")]),a("Radio",{attrs:{label:"0"}},[e._v("否")])],1)],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSubmitCheck("formData")}}},[e._v("确认提交")])],1)],1)],1)},s=[],i=(a("b0c0"),a("ac1f"),a("1276"),a("159b"),a("a434"),a("365c")),o=a("3786"),r=a("da27"),c={inject:["reload"],data:function(){return{formData:{name:"",type:"",original:"2",game_methon:"3",recom:"1",state:"1",show_down:"0",check_updateTime:"0",relation_id:"",tags:""},ruleValidate:{name:[{required:!0,message:"请输入游戏名称",trigger:"blur"}],type:[{required:!0,message:"请选择游戏类型",trigger:"change"}]},configData:{},groupid:"",type_category:"",similar_son:[],tagInfo:[],checkNameStatus:"",tagsAddConfig1:{url:"searchAllTagList",classify:1,tags:[],type:1},tagsAddConfig2:{url:"searchList",classify:1,tags:[],type:2,tagsMenu:[],gameId:this.$route.query.id},isLoaded:!1,editAllGameType:1}},created:function(){this.editAllGameType=this.$route.query.id?2:1;var e=Object(o["b"])(),t=this.$route.query.id,a=1==this.editAllGameType?{token:e}:{token:e,id:t};this.getConfig(a)},methods:{handleSubmitCheck:function(e){var t=this;if(""!=this.formData.name){var a=Object(o["b"])(),n=this.formData.name,s="game",r=this.$route.query.id,c={token:a,name:n,type:s,id:r};i["a"].checkAllName(c).then((function(a){if(0==a.code){var n=["ok","名称已存在","其他编辑正在录入...","该名称在应用中已存在"];-1==a.data[0]?t.handleSubmit(e):t.$Message.error(n[a.data[0]])}else t.$Message.error(a.msg)}))}else this.$Message.error("名称不能为空")},handleSubmit:function(e){var t=this;this.$refs[e].validate((function(e){if(e){t.$Spin.show();var a=t.clearArrSpace(t.$refs.tagsAddSwitch2.tagListStr.split(","),2),n=t.clearArrSpace(t.$refs.tagsAddSwitch1.tagListStr,1),s=Object(o["b"])(),r=1*t.$route.query.id||"",c=t.formData.name,l=1*t.formData.type,g=1*t.formData.original,d=1*t.formData.game_methon,u=1*t.formData.recom,f=1*t.formData.state,m=1*t.formData.show_down,h=1*t.formData.check_updateTime,p=n,v=a,_=1,y={token:s,id:r,name:c,type:l,original:g,game_methon:d,recom:u,state:f,show_down:m,check_updateTime:h,tags:p,relation_id:v,classify:_};i["a"].exeEditAllGame(y).then((function(e){if(t.$Spin.hide(),0==e.code){var a=setTimeout((function(){t.$Modal.remove(),t.$router.push({path:"/data/allGame"})}),5e3);t.$Modal.confirm({title:"操作成功",content:"5秒后自动跳转主游戏列表页",cancelText:"确认",okText:"下一篇",loading:!0,onCancel:function(){clearTimeout(a),t.$router.push({path:"/data/allGame"})},onOk:function(){clearTimeout(a),t.$Modal.remove(),t.$router.push({path:"/data/editallgame"})}})}else t.$Message.error(e.msg)}))}}))},getConfig:function(e){var t=this;i["a"].editAllGame(e).then((function(e){if(0==e.code){if(t.groupid=e.data.groupid,t.type_category=e.data.type_category,t.tagInfo=[],t.similar_son=[],t.configData=e.data.config,1==t.editAllGameType)t.formData={name:"",type:"",original:"2",game_methon:"3",recom:"1",state:"1",show_down:"0",check_updateTime:"0",tags:"",relation_id:""};else{t.tagInfo=e.data.tagInfo||[],t.similar_son=e.data.similar_son||[];var a=e.data.gameInfo;t.formData={name:a.name||"",type:a.type||"",original:a.original||"2",game_methon:a.game_methon||"3",recom:a.recom||"1",state:a.state||"1",show_down:a.show_down||"0",check_updateTime:"0",tags:a.tags||"",relation_id:e.data.similar_son_str||""}}t.isLoaded=!0}else t.$Notice.error({desc:e.msg})}))},checkName:function(){var e=this;if(""!=this.formData.name){var t=Object(o["b"])(),a=this.formData.name,n="game",s=this.$route.query.id,r={token:t,name:a,type:n,id:s};i["a"].checkAllName(r).then((function(t){if(0==t.code){var a=["ok","名称已存在","其他编辑正在录入...","该名称在应用中已存在"];e.checkNameStatus=-1==t.data[0]?a[0]:a[t.data[0]]}else e.$Message.error(t.msg)}))}},clearGameNameStatus:function(){this.checkNameStatus=""},clearArrSpace:function(e,t){return 2==t?(e.forEach((function(t,a){""==t&&e.splice(a,1)})),e):1==t?e:void 0}},watch:{tagInfo:function(){this.tagsAddConfig1.tags=this.tagInfo,this.tagsAddConfig2.tagsMenu=this.tagInfo},similar_son:function(){this.tagsAddConfig2.tags=this.similar_son},$route:function(e,t){e.fullPath!=t.fullPath&&this.reload()}},components:{TagsAdd:r["a"]}},l=c,g=(a("d303"),a("2877")),d=Object(g["a"])(l,n,s,!1,null,"3aea2dee",null);t["default"]=d.exports},"159b":function(e,t,a){var n=a("da84"),s=a("fdbc"),i=a("785a"),o=a("17c2"),r=a("9112"),c=function(e){if(e&&e.forEach!==o)try{r(e,"forEach",o)}catch(t){e.forEach=o}};for(var l in s)s[l]&&c(n[l]&&n[l].prototype);c(i)},"17c2":function(e,t,a){"use strict";var n=a("b727").forEach,s=a("a640"),i=s("forEach");e.exports=i?[].forEach:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}},"25f0":function(e,t,a){"use strict";var n=a("e330"),s=a("5e77").PROPER,i=a("6eeb"),o=a("825a"),r=a("3a9b"),c=a("577e"),l=a("d039"),g=a("ad6d"),d="toString",u=RegExp.prototype,f=u[d],m=n(g),h=l((function(){return"/a/b"!=f.call({source:"a",flags:"b"})})),p=s&&f.name!=d;(h||p)&&i(RegExp.prototype,d,(function(){var e=o(this),t=c(e.source),a=e.flags,n=c(void 0===a&&r(u,e)&&!("flags"in u)?m(e):a);return"/"+t+"/"+n}),{unsafe:!0})},3354:function(e,t,a){},"4d63":function(e,t,a){var n=a("83ab"),s=a("da84"),i=a("e330"),o=a("94ca"),r=a("7156"),c=a("9112"),l=a("9bf2").f,g=a("241c").f,d=a("3a9b"),u=a("44e7"),f=a("577e"),m=a("ad6d"),h=a("9f7f"),p=a("6eeb"),v=a("d039"),_=a("1a2d"),y=a("69f3").enforce,b=a("2626"),T=a("b622"),k=a("fce3"),A=a("107c"),R=T("match"),x=s.RegExp,S=x.prototype,w=s.SyntaxError,D=i(m),$=i(S.exec),C=i("".charAt),P=i("".replace),L=i("".indexOf),I=i("".slice),O=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,E=/a/g,M=/a/g,G=new x(E)!==E,N=h.UNSUPPORTED_Y,F=n&&(!G||N||k||A||v((function(){return M[R]=!1,x(E)!=E||x(M)==M||"/a/i"!=x(E,"i")}))),j=function(e){for(var t,a=e.length,n=0,s="",i=!1;n<=a;n++)t=C(e,n),"\\"!==t?i||"."!==t?("["===t?i=!0:"]"===t&&(i=!1),s+=t):s+="[\\s\\S]":s+=t+C(e,++n);return s},z=function(e){for(var t,a=e.length,n=0,s="",i=[],o={},r=!1,c=!1,l=0,g="";n<=a;n++){if(t=C(e,n),"\\"===t)t+=C(e,++n);else if("]"===t)r=!1;else if(!r)switch(!0){case"["===t:r=!0;break;case"("===t:$(O,I(e,n+1))&&(n+=2,c=!0),s+=t,l++;continue;case">"===t&&c:if(""===g||_(o,g))throw new w("Invalid capture group name");o[g]=!0,i[i.length]=[g,l],c=!1,g="";continue}c?g+=t:s+=t}return[s,i]};if(o("RegExp",F)){for(var q=function(e,t){var a,n,s,i,o,l,g=d(S,this),m=u(e),h=void 0===t,p=[],v=e;if(!g&&m&&h&&e.constructor===q)return e;if((m||d(S,e))&&(e=e.source,h&&(t="flags"in v?v.flags:D(v))),e=void 0===e?"":f(e),t=void 0===t?"":f(t),v=e,k&&"dotAll"in E&&(n=!!t&&L(t,"s")>-1,n&&(t=P(t,/s/g,""))),a=t,N&&"sticky"in E&&(s=!!t&&L(t,"y")>-1,s&&(t=P(t,/y/g,""))),A&&(i=z(e),e=i[0],p=i[1]),o=r(x(e,t),g?this:S,q),(n||s||p.length)&&(l=y(o),n&&(l.dotAll=!0,l.raw=q(j(e),a)),s&&(l.sticky=!0),p.length&&(l.groups=p)),e!==v)try{c(o,"source",""===v?"(?:)":v)}catch(_){}return o},B=function(e){e in q||l(q,e,{configurable:!0,get:function(){return x[e]},set:function(t){x[e]=t}})},J=g(x),U=0;J.length>U;)B(J[U++]);S.constructor=q,q.prototype=S,p(s,"RegExp",q)}b("RegExp")},7156:function(e,t,a){var n=a("1626"),s=a("861d"),i=a("d2bb");e.exports=function(e,t,a){var o,r;return i&&n(o=t.constructor)&&o!==a&&s(r=o.prototype)&&r!==a.prototype&&i(e,r),e}},8418:function(e,t,a){"use strict";var n=a("a04b"),s=a("9bf2"),i=a("5c6c");e.exports=function(e,t,a){var o=n(t);o in e?s.f(e,o,i(0,a)):e[o]=a}},"913d":function(e,t,a){},a434:function(e,t,a){"use strict";var n=a("23e7"),s=a("da84"),i=a("23cb"),o=a("5926"),r=a("07fa"),c=a("7b0b"),l=a("65f0"),g=a("8418"),d=a("1dde"),u=d("splice"),f=s.TypeError,m=Math.max,h=Math.min,p=9007199254740991,v="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!u},{splice:function(e,t){var a,n,s,d,u,_,y=c(this),b=r(y),T=i(e,b),k=arguments.length;if(0===k?a=n=0:1===k?(a=0,n=b-T):(a=k-2,n=h(m(o(t),0),b-T)),b+a-n>p)throw f(v);for(s=l(y,n),d=0;d<n;d++)u=T+d,u in y&&g(s,d,y[u]);if(s.length=n,a<n){for(d=T;d<b-n;d++)u=d+n,_=d+a,u in y?y[_]=y[u]:delete y[_];for(d=b;d>b-n+a;d--)delete y[d-1]}else if(a>n)for(d=b-n;d>T;d--)u=d+n-1,_=d+a-1,u in y?y[_]=y[u]:delete y[_];for(d=0;d<a;d++)y[d+T]=arguments[d+2];return y.length=b-n+a,s}})},a640:function(e,t,a){"use strict";var n=a("d039");e.exports=function(e,t){var a=[][e];return!!a&&n((function(){a.call(null,t||function(){throw 1},1)}))}},b0c0:function(e,t,a){var n=a("83ab"),s=a("5e77").EXISTS,i=a("e330"),o=a("9bf2").f,r=Function.prototype,c=i(r.toString),l=/^\s*function ([^ (]*)/,g=i(l.exec),d="name";n&&!s&&o(r,d,{configurable:!0,get:function(){try{return g(l,c(this))[1]}catch(e){return""}}})},bd40:function(e,t,a){"use strict";a("913d")},d303:function(e,t,a){"use strict";a("3354")},da27:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._l(e.tagList,(function(t,n){return a("Tag",{key:n,attrs:{name:t.name,closable:""},on:{"on-close":function(a){return e.delRelevanceTag(t.id||t.sid,n)}}},[e._v(e._s(t.name+(t.id||t.sid)))])})),a("Button",{attrs:{icon:"ios-add",type:"dashed",size:"small"},on:{click:e.openTagsAddFun}},[e._v("添加标签")]),a("Modal",{attrs:{width:"800"},model:{value:e.openTagAdd,callback:function(t){e.openTagAdd=t},expression:"openTagAdd"}},[a("p",{attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"ios-add-circle",size:"18"}}),a("span",{staticStyle:{"margin-left":"4px"}},[e._v("关联添加")])],1),a("div",{staticClass:"tagBox"},[a("div",{staticStyle:{display:"flex"}},[a("Input",{staticClass:"small",attrs:{clearable:"",search:"","enter-button":"",placeholder:"在此输入名称搜索"},on:{"on-search":function(t){return e.getRelevanceTag(!0)}},model:{value:e.selval,callback:function(t){e.selval=t},expression:"selval"}}),2==e.tagsAddConfig.type?a("Select",{staticStyle:{width:"100px",margin:"1px 0 0 10px"},on:{"on-change":function(t){return e.getRelevanceTag(!0)}},model:{value:e.getRelevanceTagParams2.tagsid1,callback:function(t){e.$set(e.getRelevanceTagParams2,"tagsid1",t)},expression:"getRelevanceTagParams2.tagsid1"}},[a("Option",{attrs:{value:"0"}},[e._v("标签")]),e._l(e.tagsMenu,(function(t,n){return a("Option",{key:n,attrs:{value:t.id}},[e._v(e._s(t.name))])}))],2):e._e(),2==e.tagsAddConfig.type?a("Select",{staticStyle:{width:"100px",margin:"1px 0 0 10px"},on:{"on-change":function(t){return e.getRelevanceTag(!0)}},model:{value:e.getRelevanceTagParams2.tagsid2,callback:function(t){e.$set(e.getRelevanceTagParams2,"tagsid2",t)},expression:"getRelevanceTagParams2.tagsid2"}},[a("Option",{attrs:{value:"0"}},[e._v("标签")]),e._l(e.tagsMenu,(function(t,n){return a("Option",{key:n,attrs:{value:t.id}},[e._v(e._s(t.name))])}))],2):e._e(),2==e.tagsAddConfig.type?a("Select",{staticStyle:{width:"100px",margin:"1px 0 0 10px"},on:{"on-change":function(t){return e.getRelevanceTag(!0)}},model:{value:e.getRelevanceTagParams2.tagsid3,callback:function(t){e.$set(e.getRelevanceTagParams2,"tagsid3",t)},expression:"getRelevanceTagParams2.tagsid3"}},[a("Option",{attrs:{value:"0"}},[e._v("标签")]),e._l(e.tagsMenu,(function(t,n){return a("Option",{key:n,attrs:{value:t.id}},[e._v(e._s(t.name))])}))],2):e._e()],1),e.relevanceTagList.gamelist&&e.relevanceTagList.gamelist.length>0?a("div",{staticClass:"tagList"},e._l(e.relevanceTagList.gamelist,(function(t,n){return a("span",{key:n,on:{click:function(a){return e.addRelevanceTag(t)}}},[e._v(" "+e._s(t.name)+" ")])})),0):a("div",{staticClass:"tagListEmpty"},[a("div",[a("Icon",{attrs:{type:"ios-ionitron-outline",size:"26"}}),e._v("查询为空")],1)])]),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Page",{staticStyle:{"text-align":"right"},attrs:{total:1*e.relevanceTagList.totlerows,"page-size":40,size:"small","show-total":"","show-sizer":""},on:{"on-page-size-change":e.changePageNum,"on-change":e.changePage}})],1)])],2)},s=[],i=(a("ac1f"),a("1276"),a("b0c0"),a("4d63"),a("25f0"),a("5319"),a("a434"),a("159b"),a("365c")),o=a("3786"),r={name:"tagsAdd",props:{tagsAddConfig:{type:Object}},data:function(){return{openTagAdd:!1,selval:"",tagList:[],tagListStr:"",relevanceTagList:{},tagsMenu:[],tagsMenuAdd:[],getRelevanceTagParams1:{token:Object(o["b"])(),page:1,per_page:40,classify:1,selval:""},getRelevanceTagParams2:{token:Object(o["b"])(),gameid:this.tagsAddConfig.gameId,page:1,per_page:40,classify:1,selval:"",tags_id:"",tagsid1:"0",tagsid2:"0",tagsid3:"0"}}},created:function(){this.tagList=this.tagsAddConfig.tags||[],this.tagsMenu=this.tagsAddConfig.tagsMenu||[],this.getTagListStr(this.tagList),this.getRelevanceTag()},methods:{openTagsAddFun:function(){this.openTagAdd=!0},getRelevanceTag:function(e){var t=this;this.getRelevanceTagParams1.selval=this.selval,this.getRelevanceTagParams2.selval=this.selval,this.getRelevanceTagParams1.classify=this.tagsAddConfig.classify||1,this.getRelevanceTagParams2.classify=this.tagsAddConfig.classify||1,e&&(1==this.tagsAddConfig.type?this.getRelevanceTagParams1.page=1:this.getRelevanceTagParams2.page=1);var a=1==this.tagsAddConfig.type?this.getRelevanceTagParams1:this.getRelevanceTagParams2;i["a"][this.tagsAddConfig.url](a).then((function(e){0==e.code?t.relevanceTagList=e.data:t.$Notice.error({desc:e.msg})}))},addRelevanceTag:function(e){var t=this.tagListStr.split(",").some((function(t){return t==e.id}));console.log(this.tagListStr,e.id,t),t?this.$Message.warning("当前关联标签id已经添加，请不要重复添加"):(this.tagListStr=this.tagListStr+=e.id+",",this.tagList.push({id:e.id,name:e.name}),this.$Message.success("关联添加成功"),1==this.tagsAddConfig.type&&(this.tagsMenuAdd=this.tagList))},delRelevanceTag:function(e,t){var a=new RegExp(e+",?");this.tagListStr=this.tagListStr.replace(a,""),this.tagList.splice(t,1)},changePage:function(e){1==this.tagsAddConfig.type?this.getRelevanceTagParams1.page=1*e:this.getRelevanceTagParams2.page=1*e,this.getRelevanceTag()},changePageNum:function(e){1==this.tagsAddConfig.type?this.getRelevanceTagParams1.page=1:this.getRelevanceTagParams2.page=1,1==this.tagsAddConfig.type?this.getRelevanceTagParams1.per_page=1*e:this.getRelevanceTagParams2.per_page=1*e,this.getRelevanceTag()},getTagListStr:function(e){var t="";e&&e.length>0?e.forEach((function(e){t+=(e.id||e.sid)+","})):t="",this.tagListStr=t}}},c=r,l=(a("bd40"),a("2877")),g=Object(l["a"])(c,n,s,!1,null,"49ce3c7a",null);t["a"]=g.exports}}]);
//# sourceMappingURL=chunk-e5006096.3b0fd150.js.map