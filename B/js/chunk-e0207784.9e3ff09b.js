(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e0207784"],{"498a":function(t,a,e){"use strict";var s=e("23e7"),i=e("58a8").trim,n=e("c8d2");s({target:"String",proto:!0,forced:n("trim")},{trim:function(){return i(this)}})},"5e1e":function(t,a,e){},"913d":function(t,a,e){},bd40:function(t,a,e){"use strict";e("913d")},c8d2:function(t,a,e){var s=e("5e77").PROPER,i=e("d039"),n=e("5899"),r="​᠎";t.exports=function(t){return i((function(){return!!n[t]()||r[t]()!==r||s&&n[t].name!==t}))}},d3db:function(t,a,e){"use strict";e("5e1e")},da27:function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[t._l(t.tagList,(function(a,s){return e("Tag",{key:s,attrs:{name:a.name,closable:""},on:{"on-close":function(e){return t.delRelevanceTag(a.id||a.sid,s)}}},[t._v(t._s(a.name+(a.id||a.sid)))])})),e("Button",{attrs:{icon:"ios-add",type:"dashed",size:"small"},on:{click:t.openTagsAddFun}},[t._v("添加标签")]),e("Modal",{attrs:{width:"800"},model:{value:t.openTagAdd,callback:function(a){t.openTagAdd=a},expression:"openTagAdd"}},[e("p",{attrs:{slot:"header"},slot:"header"},[e("Icon",{attrs:{type:"ios-add-circle",size:"18"}}),e("span",{staticStyle:{"margin-left":"4px"}},[t._v("关联添加")])],1),e("div",{staticClass:"tagBox"},[e("div",{staticStyle:{display:"flex"}},[e("Input",{staticClass:"small",attrs:{clearable:"",search:"","enter-button":"",placeholder:"在此输入名称搜索"},on:{"on-search":function(a){return t.getRelevanceTag(!0)}},model:{value:t.selval,callback:function(a){t.selval=a},expression:"selval"}}),2==t.tagsAddConfig.type?e("Select",{staticStyle:{width:"100px",margin:"1px 0 0 10px"},on:{"on-change":function(a){return t.getRelevanceTag(!0)}},model:{value:t.getRelevanceTagParams2.tagsid1,callback:function(a){t.$set(t.getRelevanceTagParams2,"tagsid1",a)},expression:"getRelevanceTagParams2.tagsid1"}},[e("Option",{attrs:{value:"0"}},[t._v("标签")]),t._l(t.tagsMenu,(function(a,s){return e("Option",{key:s,attrs:{value:a.id}},[t._v(t._s(a.name))])}))],2):t._e(),2==t.tagsAddConfig.type?e("Select",{staticStyle:{width:"100px",margin:"1px 0 0 10px"},on:{"on-change":function(a){return t.getRelevanceTag(!0)}},model:{value:t.getRelevanceTagParams2.tagsid2,callback:function(a){t.$set(t.getRelevanceTagParams2,"tagsid2",a)},expression:"getRelevanceTagParams2.tagsid2"}},[e("Option",{attrs:{value:"0"}},[t._v("标签")]),t._l(t.tagsMenu,(function(a,s){return e("Option",{key:s,attrs:{value:a.id}},[t._v(t._s(a.name))])}))],2):t._e(),2==t.tagsAddConfig.type?e("Select",{staticStyle:{width:"100px",margin:"1px 0 0 10px"},on:{"on-change":function(a){return t.getRelevanceTag(!0)}},model:{value:t.getRelevanceTagParams2.tagsid3,callback:function(a){t.$set(t.getRelevanceTagParams2,"tagsid3",a)},expression:"getRelevanceTagParams2.tagsid3"}},[e("Option",{attrs:{value:"0"}},[t._v("标签")]),t._l(t.tagsMenu,(function(a,s){return e("Option",{key:s,attrs:{value:a.id}},[t._v(t._s(a.name))])}))],2):t._e()],1),t.relevanceTagList.gamelist&&t.relevanceTagList.gamelist.length>0?e("div",{staticClass:"tagList"},t._l(t.relevanceTagList.gamelist,(function(a,s){return e("span",{key:s,on:{click:function(e){return t.addRelevanceTag(a)}}},[t._v(" "+t._s(a.name)+" ")])})),0):e("div",{staticClass:"tagListEmpty"},[e("div",[e("Icon",{attrs:{type:"ios-ionitron-outline",size:"26"}}),t._v("查询为空")],1)])]),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Page",{staticStyle:{"text-align":"right"},attrs:{total:1*t.relevanceTagList.totlerows,"page-size":40,size:"small","show-total":"","show-sizer":""},on:{"on-page-size-change":t.changePageNum,"on-change":t.changePage}})],1)])],2)},i=[],n=(e("ac1f"),e("1276"),e("b0c0"),e("4d63"),e("25f0"),e("5319"),e("a434"),e("159b"),e("365c")),r=e("3786"),o={name:"tagsAdd",props:{tagsAddConfig:{type:Object}},data:function(){return{openTagAdd:!1,selval:"",tagList:[],tagListStr:"",relevanceTagList:{},tagsMenu:[],tagsMenuAdd:[],getRelevanceTagParams1:{token:Object(r["b"])(),page:1,per_page:40,classify:1,selval:""},getRelevanceTagParams2:{token:Object(r["b"])(),gameid:this.tagsAddConfig.gameId,page:1,per_page:40,classify:1,selval:"",tags_id:"",tagsid1:"0",tagsid2:"0",tagsid3:"0"}}},created:function(){this.tagList=this.tagsAddConfig.tags||[],this.tagsMenu=this.tagsAddConfig.tagsMenu||[],this.getTagListStr(this.tagList),this.getRelevanceTag()},methods:{openTagsAddFun:function(){this.openTagAdd=!0},getRelevanceTag:function(t){var a=this;this.getRelevanceTagParams1.selval=this.selval,this.getRelevanceTagParams2.selval=this.selval,this.getRelevanceTagParams1.classify=this.tagsAddConfig.classify||1,this.getRelevanceTagParams2.classify=this.tagsAddConfig.classify||1,t&&(1==this.tagsAddConfig.type?this.getRelevanceTagParams1.page=1:this.getRelevanceTagParams2.page=1);var e=1==this.tagsAddConfig.type?this.getRelevanceTagParams1:this.getRelevanceTagParams2;n["a"][this.tagsAddConfig.url](e).then((function(t){0==t.code?a.relevanceTagList=t.data:a.$Notice.error({desc:t.msg})}))},addRelevanceTag:function(t){var a=this.tagListStr.split(",").some((function(a){return a==t.id}));console.log(this.tagListStr,t.id,a),a?this.$Message.warning("当前关联标签id已经添加，请不要重复添加"):(this.tagListStr=this.tagListStr+=t.id+",",this.tagList.push({id:t.id,name:t.name}),this.$Message.success("关联添加成功"),1==this.tagsAddConfig.type&&(this.tagsMenuAdd=this.tagList))},delRelevanceTag:function(t,a){var e=new RegExp(t+",?");this.tagListStr=this.tagListStr.replace(e,""),this.tagList.splice(a,1)},changePage:function(t){1==this.tagsAddConfig.type?this.getRelevanceTagParams1.page=1*t:this.getRelevanceTagParams2.page=1*t,this.getRelevanceTag()},changePageNum:function(t){1==this.tagsAddConfig.type?this.getRelevanceTagParams1.page=1:this.getRelevanceTagParams2.page=1,1==this.tagsAddConfig.type?this.getRelevanceTagParams1.per_page=1*t:this.getRelevanceTagParams2.per_page=1*t,this.getRelevanceTag()},getTagListStr:function(t){var a="";t&&t.length>0?t.forEach((function(t){a+=(t.id||t.sid)+","})):a="",this.tagListStr=a}}},l=o,c=(e("bd40"),e("2877")),g=Object(c["a"])(l,s,i,!1,null,"49ce3c7a",null);a["a"]=g.exports},f2b8:function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("h3",[e("Icon",{attrs:{type:"ios-add-circle-outline",size:"24"}}),t._v("编辑标签")],1),e("Form",{ref:"formData",attrs:{model:t.formData,"label-width":130,rules:t.ruleValidate}},[e("FormItem",{attrs:{label:"专题简称",prop:"name"}},[e("Input",{staticClass:"snamebox",on:{"on-blur":function(a){return t.flagtype(1)}},model:{value:t.formData.name,callback:function(a){t.$set(t.formData,"name",a)},expression:"formData.name"}}),e("span",{staticClass:"errbox",class:{err1:"ok"!=t.checkName}},[t._v(t._s(t.checkName))])],1),e("FormItem",{attrs:{label:"专题全称",prop:"fullname",model:t.formData}},[e("Input",{staticClass:"snamebox",on:{"on-blur":function(a){return t.flagtype(2)}},model:{value:t.formData.fullname,callback:function(a){t.$set(t.formData,"fullname",a)},expression:"formData.fullname"}}),e("span",{staticClass:"errbox",class:{err2:"ok"!=t.checkFullname}},[t._v(t._s(t.checkFullname))])],1),e("FormItem",{attrs:{label:"专题目录",prop:"catalog",model:t.formData}},[e("Input",{staticClass:"snamebox",on:{"on-blur":function(a){return t.flagtype(3)}},model:{value:t.formData.catalog,callback:function(a){t.$set(t.formData,"catalog",a)},expression:"formData.catalog"}}),e("span",{staticClass:"errbox",class:{err3:"ok"!=t.checkCatalog}},[t._v(t._s(t.checkCatalog))]),e("p",{staticClass:"tips"},[t._v("不能用纯数字或有中文")])],1),e("FormItem",{attrs:{label:"专题分类"}},[e("Select",{staticStyle:{width:"100px"},model:{value:t.formData.type,callback:function(a){t.$set(t.formData,"type",a)},expression:"formData.type"}},t._l(t.formArr.tag_type,(function(a,s){return e("Option",{key:s,attrs:{value:s}},[t._v(t._s(a))])})),1)],1),e("FormItem",{attrs:{label:"专题类型"}},[e("Select",{staticStyle:{width:"100px"},model:{value:t.formData.state,callback:function(a){t.$set(t.formData,"state",a)},expression:"formData.state"}},t._l(t.formArr.tag_state,(function(a,s){return e("Option",{key:s,attrs:{value:s}},[t._v(t._s(a))])})),1)],1),e("FormItem",{attrs:{label:"网页标题",prop:"title",model:t.formData}},[e("Input",{model:{value:t.formData.title,callback:function(a){t.$set(t.formData,"title",a)},expression:"formData.title"}})],1),e("FormItem",{attrs:{label:"网页关键词",prop:"keyword",model:t.formData}},[e("Input",{model:{value:t.formData.keyword,callback:function(a){t.$set(t.formData,"keyword",a)},expression:"formData.keyword"}})],1),e("FormItem",{attrs:{label:"网页描述",prop:"description",model:t.formData}},[e("Input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:15}},model:{value:t.formData.description,callback:function(a){t.$set(t.formData,"description",a)},expression:"formData.description"}})],1),e("FormItem",{attrs:{label:"是否更改更新时间",prop:"check_updateTime"}},[e("RadioGroup",{model:{value:t.formData.check_updateTime,callback:function(a){t.$set(t.formData,"check_updateTime",a)},expression:"formData.check_updateTime"}},[e("Radio",{attrs:{label:"1"}},[t._v("是")]),e("Radio",{attrs:{label:"0"}},[t._v("否")])],1)],1),e("FormItem",{attrs:{label:"作者",prop:"author",model:t.formData}},[e("Input",{staticClass:"authorbox",model:{value:t.formData.author,callback:function(a){t.$set(t.formData,"author",a)},expression:"formData.author"}})],1),e("FormItem",{attrs:{label:"关联专题",prop:"tags"}},[t.isLoaded?e("TagsAdd",{ref:"tagsAddSwitch1",attrs:{tagsAddConfig:t.tagsAddConfig1}}):t._e()],1),e("FormItem",{staticClass:"big iconBox",attrs:{label:"专题封面",prop:"img"}},[e("div",{staticClass:"uploadBox"},[e("div",{staticClass:"upload"},[e("Icon",{attrs:{type:"ios-cloud-upload-outline",size:"18"}}),t._v(" 选择文件 ")],1),e("input",{attrs:{type:"file",name:"img",value:""},on:{change:function(a){return t.getFile(a)}}})]),e("i",{staticStyle:{"margin-right":"20px"}},[t._v(t._s(t.curImgMsg.name))]),e("p",{staticClass:"tips"},[t._v("推荐尺寸:700*332")]),e("img",{staticClass:"defaultImg",attrs:{src:t.curIconUrl,alt:""}})]),e("FormItem",{attrs:{label:"专题介绍",prop:"introduce",model:t.formData}},[e("Input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:15}},model:{value:t.formData.introduce,callback:function(a){t.$set(t.formData,"introduce",a)},expression:"formData.introduce"}})],1),e("FormItem",{attrs:{label:"状态"}},[e("Select",{staticStyle:{width:"100px"},model:{value:t.formData.status,callback:function(a){t.$set(t.formData,"status",a)},expression:"formData.status"}},t._l(t.formArr.status,(function(a,s){return e("Option",{key:s,attrs:{value:s}},[t._v(t._s(a))])})),1)],1),e("FormItem",{attrs:{label:"PC404"}},[e("Select",{staticStyle:{width:"100px"},model:{value:t.formData.is404,callback:function(a){t.$set(t.formData,"is404",a)},expression:"formData.is404"}},[e("Option",{attrs:{value:"1"}},[t._v("已发布")]),e("Option",{attrs:{value:"2"}},[t._v("隐藏")]),e("Option",{attrs:{value:"3"}},[t._v("审核中")]),e("Option",{attrs:{value:"4"}},[t._v("退回")])],1)],1),e("FormItem",[e("Button",{attrs:{type:"primary"},on:{click:function(a){return t.handleSubmit("formData")}}},[t._v("确认提交")])],1)],1)],1)},i=[],n=(e("b0c0"),e("a4d3"),e("e01a"),e("498a"),e("d3b7"),e("4d63"),e("ac1f"),e("25f0"),e("159b"),e("a434"),e("365c")),r=e("3786"),o=e("da27"),l={inject:["reload"],data:function(){return{data:[],formData:{id:"",name:"",title:"",keyword:"",description:"",fullname:"",catalog:"",type:"1",introduce:"",state:"1",tag_type:"1",tag_state:"1",status:"1",website:"",img:"",is404:"2",type_category:"1",check_updateTime:"0",tags:"",flag:"",editAllPlatType:1,editAllPlat:""},ruleValidate:{name:[{required:!0,message:"请输入专题名称",trigger:"blur"}],catalog:[{required:!0,message:"请输入专题目录",trigger:"blur"}],title:[{required:!0,message:"请输入网页标题",trigger:"blur"}],keyword:[{required:!0,message:"请输入网页关键词",trigger:"blur"}],description:[{required:!0,message:"请输入网页描述",trigger:"blur"}]},formArr:{status:[],tag_state:[],tag_type:[],tags:[]},tagInfo:[],img_url:"",curIconFile:{},curIconUrl:"",curImgMsg:{name:"未选择任何文件"},checkName:"",checkFullname:"",checkCatalog:"",tagsAddConfig1:{url:"searchTagList",classify:1,tags:[],type:1},isLoaded:!1}},mounted:function(){var t=this,a=Object(r["b"])(),e=this.$route.query.id||"",s={token:a,tagid:e,type:1};this.tagid,n["a"].editTag(s).then((function(a){if(0==a.code){var s=a.data.config,i=s.status,n=s.tag_state,r=s.tag_type;if(e){var o=a.data.tagInfo,l=o.id,c=o.name,g=o.full_name,d=o.catalog,u=o.type,m=o.title,f=o.keyword,p=o.description,h=o.img,v=void 0===h?t.curIconFile:h,k=o.introduce,y=o.state,_=o.is404,b=o.tags,T=o.author,D=o.status,x=o.check_updateTime,I=void 0===x?"0":x;t.formData={id:l,name:c,fullname:g,catalog:d,type:u,title:m,keyword:f,description:p,img:v,introduce:k,state:y,is404:_,tags:b,author:T,check_updateTime:I,status:D}}t.formArr={status:i,tag_state:n,tag_type:r,tags:a.data.tagInfo1},t.tagInfo=a.data.tagInfo1||[],t.isLoaded=!0,void 0==a.data.tagInfo||(t.curIconUrl=a.data.tagInfo.img_url)}else t.$Notice.error({desc:a.msg})}))},methods:{handleSubmit:function(){var t=this;this.$Spin.show();var a=this.clearArrSpace(this.$refs.tagsAddSwitch1.tagListStr,1),e=Object(r["b"])(),s=1*this.$route.query.id||"",i=this.formData.name,o=this.formData.title,l=this.formData.keyword,c=this.formData.description,g=this.formData.fullname,d=this.formData.catalog,u=1*this.formData.status,m=1*this.formData.type,f=1*this.formData.state,p=this.formData.introduce,h=this.formData.author,v=1*this.formData.is404,k=a,y=this.curIconFile,_=1*this.formData.check_updateTime||0,b=new FormData;b.append("token",e),b.append("id",s),b.append("name",i),b.append("title",o),b.append("keyword",l),b.append("status",u),b.append("description",c),b.append("fullname",g),b.append("catalog",d),b.append("type",m),b.append("state",f),b.append("introduce",p),b.append("author",h),b.append("is404",v),b.append("relation_id",k),b.append("img",y),b.append("check_updateTime",_);var T=b;n["a"].exetag(T).then((function(a){if(t.$Spin.hide(),0==a.code){var e=setTimeout((function(){t.$Modal.remove(),t.$router.push({path:"/data/tagList"})}),5e3);t.$Modal.confirm({title:"操作成功",content:"5秒后自动跳转游戏专题列表",cancelText:"确认",okText:"下一篇",loading:!0,onCancel:function(){clearTimeout(e),t.$router.push({path:"/data/tagList"})},onOk:function(){clearTimeout(e),t.$Modal.remove(),t.$router.push({path:"/data/editTag"})}})}else t.$Message.error(a.msg)}))},flagtype:function(t){var a=this,e=1==t?this.formData.name:2==t?this.formData.fullname:this.formData.catalog;if(""!=e.trim()){var s=Object(r["b"])(),i=e,o=1,l=1*t,c=this.formData.id||"",g={token:s,name:i,type:o,flag:l,id:c};n["a"].checkTagsDirName(g).then((function(t){if(0==t.code){if(1==l)-1==t.data[0]?a.checkName="ok":1==t.data[0]&&(a.checkName="已存在");else if(2==l)-1==t.data[0]?a.checkFullname="ok":1==t.data[0]&&(a.checkFullname="已存在");else if(3==l){var e=g.name,s=/.*[\u4e00-\u9fa5]+.*$/,i=/^[0-9]*$/;if(s.test(e))return a.checkCatalog="不能含有中文",!1;if(i.test(e))return a.checkCatalog="不能为纯数字",!1;-1==t.data[0]?a.checkCatalog="ok":1==t.data[0]&&(a.checkCatalog="已存在")}}else a.$Message.error(t.msg)}))}else{var d=["专题简称","专题全称","专题目录"];this.$Message.warning("请输入".concat(d[1*t-1]))}},handleCheckName:function(){var t=this;return new Promise((function(a){var e=Object(r["b"])(),s=t.formData.name,i=i.flag,o=t.formData.flag,l=t.formData.id,c={token:e,name:s,type:i,flag:o,id:l};n["a"].checkTagsDirName(c).then((function(e){0==e.code?1==e.data.status?a({check:!0}):a({check:!1}):(a({check:!1}),t.$Message.error(e.msg))})).catch((function(e){a({check:!1}),t.$Message.error(e)}))}))},getConfig:function(t){var a=this;n["a"].exetag(t).then((function(t){if(0==t.code){if(a.data=t.data.tagInfo,a.id=t.data.id,1==a.editAllPlatType)a.formData={name:"",title:"",keyword:"",description:"",fullname:"",catalog:"",img:"",introduce:"",is404:"2",status:"1",type:"1",state:"1",author:"",check_updateTime:"0"};else{var e=t.data.tagInfo;a.formData={name:e.name||"",title:e.title||"",keyword:e.keyword||"",description:e.description||"",img:e.img||"",fullname:e.fullname||"",catalog:e.catalog||"",introduce:e.introduce||"",is404:1*e.is404||"2",tags:e.tags||"",status:1*e.status||"1",type:1*e.type||"1",state:1*e.state||"1",author:e.author||"",check_updateTime:1*e.check_updateTime||"0"}}void 0==t.data.tagInfo||(a.curIconUrl=t.data.img_url+t.data.img)}else a.$Notice.error({desc:t.msg})}))},getFile:function(t){var a=this,e=t.target.files[0],s=e.type,i="jpg|jpeg|png",n=new RegExp(".("+i+")$");if(n.test(s)){this.curIconFile=t.target.files[0],this.curImgMsg=t.target.files[0];var r=new FileReader;r.onload=function(){a.curIconUrl=r.result},r.readAsDataURL(this.curImgMsg)}else this.$Message.warning("请传".concat(i,"图片"))},clearArrSpace:function(t,a){return 2==a?(t.forEach((function(a,e){""==a&&t.splice(e,1)})),t):1==a?t:void 0}},watch:{tagInfo:function(){this.tagsAddConfig1.tags=this.formArr.tags},$route:function(t,a){t.fullPath!=a.fullPath&&this.reload()}},components:{TagsAdd:o["a"]}},c=l,g=(e("d3db"),e("2877")),d=Object(g["a"])(c,s,i,!1,null,"4f97e37e",null);a["default"]=d.exports}}]);
//# sourceMappingURL=chunk-e0207784.9e3ff09b.js.map